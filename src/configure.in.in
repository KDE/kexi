
#DO_NOT_COMPILE="$DO_NOT_COMPILE kexi"


# -- Check for KDE 3.1 and enable the compat dir --------------------

AC_MSG_CHECKING([for kdelibs newer than 3.1.x])

AC_LANG_SAVE
AC_LANG_CPLUSPLUS
kcompat_save_CXXFLAGS="$CXXFLAGS"
kcompat_safe_LIBS="$LIBS"
LIBS="$LIBS $X_EXTRA_LIBS"
echo "all_includes=$all_includes"
CXXFLAGS="$CXXFLAGS $all_includes"

AC_TRY_COMPILE([
#include <kdeversion.h>
#if !( KDE_IS_VERSION( 3, 1, 90 ) )
#error Need to enable kexi_compat
#endif
],
[
],
	use_kexi_compat_qextmdi="no"
	AC_SUBST(LIB_KEXI_KMDI, '-lkmdi')
	AC_MSG_RESULT(yes)
,
	use_kexi_compat_qextmdi="yes"
	AC_SUBST(LIB_KEXI_KMDI_INCLUDES, '-I$(top_srcdir)/../kexi_compat/qextmdi')
	AC_SUBST(LIB_KEXI_KMDI, -lkexi_compat_qextmdi)
	
	AC_MSG_RESULT(no)
	echo "  libkexi_compat_qextmdi will be used instead of libkmdi."
)
CXXFLAGS="$kcompat_save_CXXFLAGS"
LIBS="$kcompat_safe_LIBS"
AC_LANG_RESTORE

AM_CONDITIONAL(use_kexi_compat_qextmdi, test "$use_kexi_compat_qextmdi" == "yes")

# -- End KDE 3.1 check ----------------------------------------------

